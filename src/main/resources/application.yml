server:
  port: 8080

spring:
  application:
    name: carpet-backend

  # Mongo（你日志里实际在用）
  data:
    mongodb:
      host: localhost
      port: 27017
      database: carpetdb

  # Kafka：加上 admin（自动创建 topic）和合理超时，避免卡请求
  kafka:
    bootstrap-servers: localhost:9092
    admin:
      fail-fast: true
    producer:
      # 避免阻塞请求线程：不要使用 send().get()；以下超时缩短失败感知时间
      properties:
        request.timeout.ms: 3000
        delivery.timeout.ms: 3000
        max.block.ms: 2000
    consumer:
      group-id: carpet-group
      auto-offset-reset: earliest
    listener:
      ack-mode: record

  # JPA/Hibernate configuration for PostgreSQL
  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true

  cassandra:
    contact-points: 127.0.0.1
    port: 9042
    local-datacenter: datacenter1   # ← 必须与实际一致
    keyspace-name: yancarpet         # 你的 keyspace；没有就先建
    schema-action: create_if_not_exists

  # PostgreSQL configuration - Update with YOUR credentials
  datasource:
    url: jdbc:postgresql://localhost:5432/carpetdb
    username: postgres  # Your PostgreSQL username
    password: secret  # PostgreSQL password!
    driver-class-name: org.postgresql.Driver

logging:
  level:
    org.springframework.web: INFO
    org.springframework.data.mongodb.core.MongoTemplate: INFO
    org.springframework.security: DEBUG
    org.example.carpet: DEBUG
    org.apache.kafka.clients.admin: WARN
    org.apache.kafka.clients.Metadata: WARN

app:
  jwt:
    secret: change-me-please
    ttlSeconds: 86400
